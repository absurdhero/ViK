#!/usr/bin/env ruby

require 'optparse'

def run(files)
  require 'screen'
  require 'editor'
  require 'text_buffer'
  require 'display_buffer'

  screen = CursesScreen.new

  screen.status_bar.right("ViK")
  screen.refresh

  text = TextBuffer.new
  display_buffer = DisplayBuffer.new(screen, text)
  editor = Editor.new(display_buffer, screen.status_bar)

  loop do
      key = screen.get_key
      screen.status_bar.right(key.to_s)
      begin
          editor.handle_key(key)
      rescue QuitSignal
          break
      end
  end
end

optparse = OptionParser.new do|opts|
    opts.banner = "Usage: vik [options] file1 file2 ..."

    opts.on( '-h', '--help', 'Display this screen' ) do
        puts opts
        exit
    end
end

optparse.parse!

run(ARGV)
